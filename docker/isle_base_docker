FROM nvcr.io/nvidia/nvhpc:21.1-devel-cuda11.2-ubuntu20.04

RUN uname -r >> /build-info.txt

RUN apt-get update -y && apt-get -y --no-install-recommends install \
    build-essential gcc libssl-dev libffi-dev liblapack-dev python3-dev python3-pip \
    git cmake && \
    yes | pip3 install setuptools psutil pybind11 numpy scipy h5py PyYAML scikit-learn matplotlib

#  


RUN git clone https://bitbucket.org/blaze-lib/blaze.git /var/tmp/blaze && \
    mkdir /var/tmp/blaze/build && \
    cd /var/tmp/blaze/build/ && \
    cmake .. -DCMAKE_INSTALL_PREFIX=/usr/local/ && \
    make install
