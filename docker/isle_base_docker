# Choose base image, distribution we want to use
FROM nvidia/cuda:11.2.1-devel-ubuntu20.04

# Write Out build info
RUN uname -r >> /build-info.txt

ARG DEBIAN_FRONTEND=noninteractive

# system configuration
RUN apt-get update -y && apt-get -y --no-install-recommends install \
    build-essential gcc libssl-dev libffi-dev python3-dev python3-pip \
    git cmake liblapack-dev && \
    yes | pip3 install setuptools pybind11 numpy scipy h5py PyYAML scikit-learn matplotlib

# Install blaze
WORKDIR /var/tmp/blaze
RUN git clone https://bitbucket.org/blaze-lib/blaze.git /var/tmp/blaze && \
    mkdir /var/tmp/blaze/build && \
    cd build/ && \
    cmake .. -DCMAKE_INSTALL_PREFIX=/usr/local/ && \
    make install
